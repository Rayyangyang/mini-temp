"use weex:vue";

if (typeof Promise !== 'undefined' && !Promise.prototype.finally) {
  Promise.prototype.finally = function(callback) {
    const promise = this.constructor
    return this.then(
      value => promise.resolve(callback()).then(() => value),
      reason => promise.resolve(callback()).then(() => {
        throw reason
      })
    )
  }
};

if (typeof uni !== 'undefined' && uni && uni.requireGlobal) {
  const global = uni.requireGlobal()
  ArrayBuffer = global.ArrayBuffer
  Int8Array = global.Int8Array
  Uint8Array = global.Uint8Array
  Uint8ClampedArray = global.Uint8ClampedArray
  Int16Array = global.Int16Array
  Uint16Array = global.Uint16Array
  Int32Array = global.Int32Array
  Uint32Array = global.Uint32Array
  Float32Array = global.Float32Array
  Float64Array = global.Float64Array
  BigInt64Array = global.BigInt64Array
  BigUint64Array = global.BigUint64Array
};


(()=>{var H=Object.create;var F=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var $=Object.getOwnPropertyNames;var j=Object.getPrototypeOf,J=Object.prototype.hasOwnProperty;var E=(a,s)=>()=>(s||a((s={exports:{}}).exports,s),s.exports);var Q=(a,s,o,c)=>{if(s&&typeof s=="object"||typeof s=="function")for(let p of $(s))!J.call(a,p)&&p!==o&&F(a,p,{get:()=>s[p],enumerable:!(c=G(s,p))||c.enumerable});return a};var k=(a,s,o)=>(o=a!=null?H(j(a)):{},Q(s||!a||!a.__esModule?F(o,"default",{value:a,enumerable:!0}):o,a));var x=(a,s,o)=>new Promise((c,p)=>{var l=h=>{try{n(o.next(h))}catch(t){p(t)}},d=h=>{try{n(o.throw(h))}catch(t){p(t)}},n=h=>h.done?c(h.value):Promise.resolve(h.value).then(l,d);n((o=o.apply(a,s)).next())});var I=E((ht,A)=>{A.exports=Vue});var b=E((gt,W)=>{W.exports=uni.Pinia});var f=k(I()),m=k(b()),Y=Object.defineProperty,D=Object.getOwnPropertySymbols,Z=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable,P=(a,s,o)=>s in a?Y(a,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):a[s]=o,X=(a,s)=>{for(var o in s||(s={}))Z.call(s,o)&&P(a,o,s[o]);if(D)for(var o of D(s))K.call(s,o)&&P(a,o,s[o]);return a};function tt(){return uni.getSubNVueById(plus.webview.currentWebview().id)}function C(a,s,...o){uni.__log__?uni.__log__(a,s,...o):console[a].apply(console,[...o,s])}var et="/static/app-plus/lib_update_app_top_bg.png",rt="/static/app-plus/lib_update_app_close.png",nt="http://47.106.228.230:8080/yijie",ot=()=>{try{return uni.getStorageSync("token")}catch(a){}return null},V={exports:{}},N={exports:{}};(function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s={rotl:function(o,c){return o<<c|o>>>32-c},rotr:function(o,c){return o<<32-c|o>>>c},endian:function(o){if(o.constructor==Number)return s.rotl(o,8)&16711935|s.rotl(o,24)&4278255360;for(var c=0;c<o.length;c++)o[c]=s.endian(o[c]);return o},randomBytes:function(o){for(var c=[];o>0;o--)c.push(Math.floor(Math.random()*256));return c},bytesToWords:function(o){for(var c=[],p=0,l=0;p<o.length;p++,l+=8)c[l>>>5]|=o[p]<<24-l%32;return c},wordsToBytes:function(o){for(var c=[],p=0;p<o.length*32;p+=8)c.push(o[p>>>5]>>>24-p%32&255);return c},bytesToHex:function(o){for(var c=[],p=0;p<o.length;p++)c.push((o[p]>>>4).toString(16)),c.push((o[p]&15).toString(16));return c.join("")},hexToBytes:function(o){for(var c=[],p=0;p<o.length;p+=2)c.push(parseInt(o.substr(p,2),16));return c},bytesToBase64:function(o){for(var c=[],p=0;p<o.length;p+=3)for(var l=o[p]<<16|o[p+1]<<8|o[p+2],d=0;d<4;d++)p*8+d*6<=o.length*8?c.push(a.charAt(l>>>6*(3-d)&63)):c.push("=");return c.join("")},base64ToBytes:function(o){o=o.replace(/[^A-Z0-9+\/]/ig,"");for(var c=[],p=0,l=0;p<o.length;l=++p%4)l!=0&&c.push((a.indexOf(o.charAt(p-1))&Math.pow(2,-2*l+8)-1)<<l*2|a.indexOf(o.charAt(p))>>>6-l*2);return c}};N.exports=s})();var B={utf8:{stringToBytes:function(a){return B.bin.stringToBytes(unescape(encodeURIComponent(a)))},bytesToString:function(a){return decodeURIComponent(escape(B.bin.bytesToString(a)))}},bin:{stringToBytes:function(a){for(var s=[],o=0;o<a.length;o++)s.push(a.charCodeAt(o)&255);return s},bytesToString:function(a){for(var s=[],o=0;o<a.length;o++)s.push(String.fromCharCode(a[o]));return s.join("")}}},U=B;var ut=function(a){return a!=null&&(L(a)||at(a)||!!a._isBuffer)};function L(a){return!!a.constructor&&typeof a.constructor.isBuffer=="function"&&a.constructor.isBuffer(a)}function at(a){return typeof a.readFloatLE=="function"&&typeof a.slice=="function"&&L(a.slice(0,0))}(function(){var a=N.exports,s=U.utf8,o=ut,c=U.bin,p=function(l,d){l.constructor==String?d&&d.encoding==="binary"?l=c.stringToBytes(l):l=s.stringToBytes(l):o(l)?l=Array.prototype.slice.call(l,0):!Array.isArray(l)&&l.constructor!==Uint8Array&&(l=l.toString());for(var n=a.bytesToWords(l),h=l.length*8,t=1732584193,e=-271733879,u=-1732584194,r=271733878,i=0;i<n.length;i++)n[i]=(n[i]<<8|n[i]>>>24)&16711935|(n[i]<<24|n[i]>>>8)&4278255360;n[h>>>5]|=128<<h%32,n[(h+64>>>9<<4)+14]=h;for(var g=p._ff,v=p._gg,_=p._hh,w=p._ii,i=0;i<n.length;i+=16){var M=t,R=e,q=u,z=r;t=g(t,e,u,r,n[i+0],7,-680876936),r=g(r,t,e,u,n[i+1],12,-389564586),u=g(u,r,t,e,n[i+2],17,606105819),e=g(e,u,r,t,n[i+3],22,-1044525330),t=g(t,e,u,r,n[i+4],7,-176418897),r=g(r,t,e,u,n[i+5],12,1200080426),u=g(u,r,t,e,n[i+6],17,-1473231341),e=g(e,u,r,t,n[i+7],22,-45705983),t=g(t,e,u,r,n[i+8],7,1770035416),r=g(r,t,e,u,n[i+9],12,-1958414417),u=g(u,r,t,e,n[i+10],17,-42063),e=g(e,u,r,t,n[i+11],22,-1990404162),t=g(t,e,u,r,n[i+12],7,1804603682),r=g(r,t,e,u,n[i+13],12,-40341101),u=g(u,r,t,e,n[i+14],17,-1502002290),e=g(e,u,r,t,n[i+15],22,1236535329),t=v(t,e,u,r,n[i+1],5,-165796510),r=v(r,t,e,u,n[i+6],9,-1069501632),u=v(u,r,t,e,n[i+11],14,643717713),e=v(e,u,r,t,n[i+0],20,-373897302),t=v(t,e,u,r,n[i+5],5,-701558691),r=v(r,t,e,u,n[i+10],9,38016083),u=v(u,r,t,e,n[i+15],14,-660478335),e=v(e,u,r,t,n[i+4],20,-405537848),t=v(t,e,u,r,n[i+9],5,568446438),r=v(r,t,e,u,n[i+14],9,-1019803690),u=v(u,r,t,e,n[i+3],14,-187363961),e=v(e,u,r,t,n[i+8],20,1163531501),t=v(t,e,u,r,n[i+13],5,-1444681467),r=v(r,t,e,u,n[i+2],9,-51403784),u=v(u,r,t,e,n[i+7],14,1735328473),e=v(e,u,r,t,n[i+12],20,-1926607734),t=_(t,e,u,r,n[i+5],4,-378558),r=_(r,t,e,u,n[i+8],11,-2022574463),u=_(u,r,t,e,n[i+11],16,1839030562),e=_(e,u,r,t,n[i+14],23,-35309556),t=_(t,e,u,r,n[i+1],4,-1530992060),r=_(r,t,e,u,n[i+4],11,1272893353),u=_(u,r,t,e,n[i+7],16,-155497632),e=_(e,u,r,t,n[i+10],23,-1094730640),t=_(t,e,u,r,n[i+13],4,681279174),r=_(r,t,e,u,n[i+0],11,-358537222),u=_(u,r,t,e,n[i+3],16,-722521979),e=_(e,u,r,t,n[i+6],23,76029189),t=_(t,e,u,r,n[i+9],4,-640364487),r=_(r,t,e,u,n[i+12],11,-421815835),u=_(u,r,t,e,n[i+15],16,530742520),e=_(e,u,r,t,n[i+2],23,-995338651),t=w(t,e,u,r,n[i+0],6,-198630844),r=w(r,t,e,u,n[i+7],10,1126891415),u=w(u,r,t,e,n[i+14],15,-1416354905),e=w(e,u,r,t,n[i+5],21,-57434055),t=w(t,e,u,r,n[i+12],6,1700485571),r=w(r,t,e,u,n[i+3],10,-1894986606),u=w(u,r,t,e,n[i+10],15,-1051523),e=w(e,u,r,t,n[i+1],21,-2054922799),t=w(t,e,u,r,n[i+8],6,1873313359),r=w(r,t,e,u,n[i+15],10,-30611744),u=w(u,r,t,e,n[i+6],15,-1560198380),e=w(e,u,r,t,n[i+13],21,1309151649),t=w(t,e,u,r,n[i+4],6,-145523070),r=w(r,t,e,u,n[i+11],10,-1120210379),u=w(u,r,t,e,n[i+2],15,718787259),e=w(e,u,r,t,n[i+9],21,-343485551),t=t+M>>>0,e=e+R>>>0,u=u+q>>>0,r=r+z>>>0}return a.endian([t,e,u,r])};p._ff=function(l,d,n,h,t,e,u){var r=l+(d&n|~d&h)+(t>>>0)+u;return(r<<e|r>>>32-e)+d},p._gg=function(l,d,n,h,t,e,u){var r=l+(d&h|n&~h)+(t>>>0)+u;return(r<<e|r>>>32-e)+d},p._hh=function(l,d,n,h,t,e,u){var r=l+(d^n^h)+(t>>>0)+u;return(r<<e|r>>>32-e)+d},p._ii=function(l,d,n,h,t,e,u){var r=l+(n^(d|~h))+(t>>>0)+u;return(r<<e|r>>>32-e)+d},p._blocksize=16,p._digestsize=16,V.exports=function(l,d){if(l==null)throw new Error("Illegal argument "+l);var n=a.wordsToBytes(p(l,d));return d&&d.asBytes?n:d&&d.asString?c.bytesToString(n):a.bytesToHex(n)}})();var O=V.exports,y=!1;function it(p,l){return x(this,arguments,function*(a,{data:s,method:o,requestType:c}){Object.keys(s).forEach(t=>[void 0,null].includes(s[t])&&delete s[t]),a.substr(0,4)!="http"&&(a=nt+a),C("log","at utils/request.js:8",a,s);let d=new Date().getTime(),n=Math.floor(Math.random()*100);return yield uni.request({url:a,data:s,method:(o==null?void 0:o.toUpperCase())||"GET",header:{"Content-Type":c=="json"?"application/json":"application/x-www-form-urlencoded",token:ot()||"","api-version":1,timestamp:d,rand:n,apiSecret:O(O(d+"ccys"+n))}}).then(t=>{if(t.statusCode==200)return t.data;if(t.statusCode==401)throw uni.removeStorageSync("unionuser"),uni.removeStorageSync("token"),uni.hideLoading(),uni.hideToast(),y||(y=!0,uni.showModal({title:"\u6CE8\u610F",content:"\u60A8\u7684\u767B\u5F55\u4FE1\u606F\u5DF2\u8FC7\u671F\uFF0C\u8BF7\u91CD\u65B0\u767B\u5F55\uFF01",showCancel:!1,success:e=>{e.confirm&&(C("log","at utils/request.js:40","\u7528\u6237\u70B9\u51FB\u786E\u5B9A"),y=!1)}})),t;y||(y=!0,uni.showModal({title:String(t.data.status),content:t.data.error,showCancel:!1,confirmText:"\u77E5\u9053\u4E86",success:e=>{e.confirm&&(y=!1)}}))}).catch(t=>{throw C("log","at utils/request.js:64",t,"catchRes"),!y&&!t.statusCode&&(y=!0,uni.showModal({title:"\u7F51\u7EDC\u9519\u8BEF",content:"net::ERR_FAILED",showCancel:!1,confirmText:"\u77E5\u9053\u4E86",success:e=>{e.confirm&&(y=!1)}})),t})})}function st(a){return x(this,null,function*(){return it("/common/checkUpdate",{data:a})})}var pt=(0,m.defineStore)("global",{state:()=>({apkInfo:{},haveNew:!1}),actions:{checkAndroidUpdate(a){return x(this,null,function*(){let s=yield st(X({},a));return s.id&&(this.apkInfo=s,plus.runtime.getProperty(plus.runtime.appid,o=>{o.version!=s.newVersion&&(setTimeout(()=>uni.getSubNVueById("appUpdate").show(),500),this.haveNew=!0)})),s})}}}),ct={container:{"":{position:"relative",flex:1,justifyContent:"center",alignItems:"center"}},updateWrap:{"":{alignItems:"center"}},topIcon:{".updateWrap ":{width:"640rpx"}},updateContent:{".updateWrap ":{width:"640rpx",backgroundColor:"#ffffff",paddingTop:"30rpx",paddingRight:"30rpx",paddingBottom:"30rpx",paddingLeft:"30rpx"}},updateTitleText:{".updateWrap .updateContent ":{fontSize:"32rpx",color:"#333333"}},updateDescText:{".updateWrap .updateContent ":{fontSize:"28rpx",color:"#666666",marginTop:"10rpx"}},downloadProgress:{".updateWrap .updateContent ":{marginTop:"20rpx"}},downLoadText:{".updateWrap .updateContent ":{fontSize:"28rpx",color:"#666666",marginTop:"10rpx",textAlign:"center"}},updateBtnText:{".updateWrap .updateContent ":{width:"580rpx",height:"80rpx",textAlign:"center",backgroundColor:"#e84339",color:"#ffffff",lineHeight:"80rpx",borderRadius:"20rpx",fontSize:"34rpx",marginTop:"20rpx"}},line:{".updateWrap ":{borderLeftWidth:1,borderLeftStyle:"solid",borderLeftColor:"#ffffff",width:0,height:"100rpx"}},closeIcon:{".updateWrap ":{width:"60rpx"}}},lt=(a,s)=>{let o=a.__vccOpts||a;for(let[c,p]of s)o[c]=p;return o},ft={__name:"appUpdate",setup(a){let s=pt(),{apkInfo:o}=(0,m.storeToRefs)(s),c=(0,f.ref)(!1),p=(0,f.ref)(0),l,d=()=>{tt().hide(),l==null||l.abort()},n=()=>{c.value=!0,l=uni.downloadFile({url:o.value.apkFileUrl,success:h=>{plus.runtime.install(h.tempFilePath,{force:!0},()=>plus.runtime.restart())}}),l.onProgressUpdate(h=>p.value=h.progress)};return(h,t)=>((0,f.openBlock)(),(0,f.createElementBlock)("scroll-view",{scrollY:!0,showScrollbar:!0,enableBackToTop:!0,bubble:"true",style:{flexDirection:"column"}},[(0,f.createElementVNode)("view",{class:"container"},[(0,f.createElementVNode)("view",{class:"updateWrap"},[(0,f.createElementVNode)("u-image",{class:"topIcon",mode:"widthFix",src:et}),(0,f.createElementVNode)("view",{class:"updateContent"},[(0,f.createElementVNode)("u-text",{class:"updateTitleText"},"\u68C0\u6D4B\u5230\u6709\u65B0\u7684\u7248\u672Cv."+(0,f.toDisplayString)((0,f.unref)(o).newVersion)+" \u662F\u5426\u66F4\u65B0\uFF1F",1),(0,f.createElementVNode)("u-text",{class:"updateDescText"},(0,f.toDisplayString)((0,f.unref)(o).updateLog),1),c.value?((0,f.openBlock)(),(0,f.createElementBlock)(f.Fragment,{key:0},[(0,f.createVNode)((0,f.unref)(p),{percent:p.value,"show-info":"",class:"downloadProgress",activeColor:"#E84339"},null,8,["percent"]),(0,f.createElementVNode)("u-text",{class:"downLoadText"},"\u8D44\u6E90\u4E0B\u8F7D\u4E2D\uFF0C\u8BF7\u7A0D\u540E...")],64)):((0,f.openBlock)(),(0,f.createElementBlock)("u-text",{key:1,onClick:n,class:"updateBtnText"},"\u7ACB\u5373\u5347\u7EA7"))]),(0,f.unref)(o).isConstraint?(0,f.createCommentVNode)("",!0):((0,f.openBlock)(),(0,f.createElementBlock)("view",{key:0,class:"line"})),(0,f.unref)(o).isConstraint?(0,f.createCommentVNode)("",!0):((0,f.openBlock)(),(0,f.createElementBlock)("u-image",{key:1,onClick:d,class:"closeIcon",mode:"widthFix",src:rt}))])])]))}},T=lt(ft,[["styles",[ct]]]);var S=plus.webview.currentWebview();if(S){let a=parseInt(S.id),s="platforms/app-plus/subNVue/appUpdate",o={};try{o=JSON.parse(S.__query__)}catch(p){}T.mpType="page";let c=Vue.createPageApp(T,{$store:getApp({allowDefault:!0}).$store,__pageId:a,__pagePath:s,__pageQuery:o});c.provide("__globalStyles",Vue.useCssStyles([...__uniConfig.styles,...T.styles||[]])),c.mount("#root")}})();
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
